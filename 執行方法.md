# 執行方法

專案根目錄

```
├─ 105年A1-A4所有當事人.xlsx              # 資料檔案
├─ 106年A1-A4所有當事人.xlsx              # 資料檔案
├─ 107年A1-A4所有當事人(新增戶籍地).xlsx   # 資料檔案
├─ 108年A1-A4所有當事人(新增戶籍地).xlsx   # 資料檔案
├─ 109年A1-A4所有當事人(新增戶籍地).xlsx   # 資料檔案
│
├─ data.py                                # 執行步驟一：資料處理
├─ RandomForest.py                        # 執行步驟二：特徵分析
├─ model_training.py                      # 執行步驟三：模型訓練與評估
├─ shap_analysis.py                       # 執行步驟四：結果分析（SHAP）
│
├─ step1.csv                              # 步驟一輸出的合併資料檔
├─ step2.csv                              # 步驟二輸出的篩選特徵檔案
│
├─ model/                                 # 模型儲存目錄（包含最佳模型.joblib）
└─ 執行方法.md                             # 本文件
```

---

## 簡介

本計畫透過資料清理處理、特徵分析和模型訓練，建構一個高效的車禍類型分類模型，並使用 SHAP 分析每年車禍結果的分類變化趨勢與特徵重要性。

---

## 步驟一：資料處理

```
python data.py
```

- 合併 105 ~ 109 年 A1 ~ A4 當事人 Excel 原始資料
- 提取時間與空間特徵（年、月、時、經緯度等）
- 編碼晝夜變數與行政區等類別欄位
- 產出 `step1.csv`（合併與清洗完成的訓練資料）

---

## 步驟二：特徵重要性分析

```
python RandomForest.py
```

- 讀取 `step1.csv`
- 使用隨機森林模型計算每個特徵的重要性
- 篩選並輸出貢獻度較高的變數至 `step2.csv`

---

## 步驟三：模型訓練與預測

```
python model_training.py
```

- 讀取 `step2.csv`
- 使用多種分類器進行模型訓練與比較（如 RF、XGBoost、DecisionTree）
- 將最佳模型儲存於 `/model` 目錄

---

## 步驟四：結果解釋與可視化（SHAP）

```
python shap_analysis.py
```

- 載入訓練好的模型與測試集資料
- 使用 SHAP 分析特徵對預測結果的貢獻
- 產出 summary plot、dependence plot 等視覺化圖表

---

## 預期成果

- 一個可穩定分類車禍類型的高準確模型
- 每年不同特徵的重要性排名（使用 SHAP 解釋）
- 支援後續決策與政策調整的資料基礎與視覺化工具

---

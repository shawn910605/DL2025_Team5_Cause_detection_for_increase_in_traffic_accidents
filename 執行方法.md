# 執行方法
專案根目錄
│
├－105年A1-A4所有當事人.xlsx #資料資料
├－106年A1-A4所有當事人.xlsx #資料資料
├－107年A1-A4所有當事人(新增戶籍地).xlsx #資料資料
├－108年A1-A4所有當事人(新增戶籍地).xlsx #資料資料
├－109年A1-A4所有當事人(新增戶籍地).xlsx #資料資料
├── data.py # 執行步驟1：資料處理
├── RandomForest.py # 執行步驟2：特徵分析
├── model_training.py # 執行步驟3：模型訓練與評估
├── shap_analysis.py # 執行步驟4：結果分析
├── step1.csv # 步驟1產生的合併資料文件
├── step2.csv # 步驟2產生的特徵重要性文件
└── model # 專案簡介與執行方法（本文件）
 └──各種模型
## 簡介

本計畫旨在透過資料處理、特徵分析和模型訓練，建構一個高效的車禍類型分類模型，並使用SHAP分析每年車禍結果的分類變化。以下是具體的執行步驟。

## 步驟1：資料處理

### `python data.py`

#### 功能
- 讀取Excel文件，合併處理105年至109年的數據，並產生`step1.csv`文件。

#### 實現
- 使用`pandas`庫讀取Excel文件，處理資料空缺和資料排版不一致的問題。
- 合併多年的數據，統一格式，轉換為單一的csv檔。

## 步驟2：特徵分析

### `python RandomForest.py`

#### 功能
- 讀取`step1.csv`文件，透過隨機森林分析特徵的重要性，並將貢獻較大的特徵輸出到`step2.csv`文件。

#### 實現
- 使用`pandas`庫讀取`step1.csv`文件，進行資料預處理。
- 使用`sklearn`庫的`RandomForestClassifier`分析特徵重要性，篩選出貢獻較大的特徵。

## 步驟3：模型訓練與評估

### `python model_training.py`

#### 功能
- 讀取`step2.csv`文件，使用各種分類模型調試並選擇最佳模型進行車禍類型分類。

#### 實現
- 使用`pandas`庫讀取`step2.csv`文件，進行資料預處理。
- 嘗試多種分類模型（如決策樹、隨機森林、梯度提升等），調整參數並選擇最佳模型。

## 步驟4：結果分析

### `python shap_analysis.py`

#### 功能
- 使用調試好的最佳模型結合SHAP分析每年車禍結果的分類變化。

#### 實現
- 使用`pandas`函式庫讀取數據，結合SHAP函式庫分析特徵對預測結果的貢獻。
- 輸出每年車禍類型分類結果的變化趨勢。
